(this.webpackJsonpfinance=this.webpackJsonpfinance||[]).push([[1],{111:function(e,t,n){"use strict";n.r(t);n(62),n(63);var a=n(18),o=(n(64),n(1)),c=n.n(o),r=n(23),s=n(5),i=n(6),l=n(41),u=n(42),m=n(44),h=n(43),p=(n(66),n(19)),d=n(55),E=n.n(d),f=(n(95),n(2)),b=n.n(f);function y(e){return o.createElement("div",{className:b()("sk-folding-cube-wrapper",e.className)},o.createElement("div",{className:"sk-folding-cube",title:e.title},o.createElement("div",{className:"sk-cube1 sk-cube"}),o.createElement("div",{className:"sk-cube2 sk-cube"}),o.createElement("div",{className:"sk-cube4 sk-cube"}),o.createElement("div",{className:"sk-cube3 sk-cube"})))}var S=n(15),g=new window.Intl.DateTimeFormat(void 0,{day:"numeric",hour:"numeric",hour12:!1,minute:"numeric",month:"numeric",second:"numeric",year:"numeric"});function O(e,t,n){var a=n.toUpperCase(),o=[];return t.some((function(t){return!(!t.symbol.startsWith(a)||(o.push(t),o.length!==e))})),o}function _(){}function T(e,t){var n=t.query,a=e.symbol.slice(0,n.length),c=e.symbol.slice(n.length);return o.createElement("span",null,o.createElement("strong",null,a),o.createElement("span",null,c)," - ",e.name)}function A(e){return e.symbol}var C=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleSearchBlur=function(){a.setState({searchIsFocused:!1})},a.handleSearchFocus=function(){null==a.props.allIexSymbols&&a.props.dispatch(Object(p.g)()),a.setState({searchIsFocused:!0})},a.handleSearchQueryChange=function(e){"INPUT"===e.currentTarget.nodeName&&a.setSearchQuery(e.currentTarget.value)},a.handleSearchQueryClear=function(){a.setSearchQuery("")},a.handleSearchSubmit=function(e){e.preventDefault()},a.handleSetIexApiKey=function(e){e.preventDefault(),a.props.dispatch(Object(p.k)(a.state.nextIexApiKey)),a.closeActiveModal()},a.handleSuggestionSelected=function(e,t){var n=t.suggestionValue;a.props.history.push("/stocks/".concat(n))},a.closeActiveModal=function(){a.setState({activeModal:null})},a.openSettingsModal=function(){a.setState({activeModal:{type:"settings"},nextIexApiKey:null==a.props.iexApiKey?"":a.props.iexApiKey})},a.setNextIexApiKey=function(e){a.setState({nextIexApiKey:e.target.value})},a.toggle=function(){a.setState({isOpen:!a.state.isOpen})},a.state={activeModal:null,isOpen:!1,nextIexApiKey:"",searchIsFocused:!1,searchQuery:"",searchResults:[]},a}return Object(u.a)(n,[{key:"setSearchQuery",value:function(e){this.setState({searchQuery:e,searchResults:null==this.props.allIexSymbols?[]:O(5,this.props.allIexSymbols,e)})}},{key:"render",value:function(){var e=this.props,t=e.fetchErrorMessage,n=e.updatedAt;return o.createElement(i.n,{color:"dark",dark:!0,expand:"md"},o.createElement(i.o,{className:"text-warning",tag:r.c,to:"/"},"Finance!"),o.createElement(i.p,{onClick:this.toggle}),o.createElement(i.c,{isOpen:this.state.isOpen,navbar:!0},o.createElement(i.e,{action:"/finance/stocks",className:"mr-auto",inline:!0,onSubmit:this.handleSearchSubmit},o.createElement(E.a,{getSuggestionValue:A,highlightFirstSuggestion:!0,inputProps:{name:"symbol",onBlur:this.handleSearchBlur,onChange:this.handleSearchQueryChange,onFocus:this.handleSearchFocus,placeholder:"Search...",value:this.state.searchQuery},onSuggestionsClearRequested:this.handleSearchQueryClear,onSuggestionsFetchRequested:_,onSuggestionSelected:this.handleSuggestionSelected,renderSuggestion:T,suggestions:this.state.searchResults,theme:{container:"autosuggest",input:b()("dark-transition form-control",{"bg-dark":!this.state.searchIsFocused}),suggestionsContainer:"dropdown",suggestionsList:"dropdown-menu ".concat(this.state.searchResults.length>0?"show":""),suggestion:"dropdown-item",suggestionHighlighted:"active"}})),this.props.isLoading?o.createElement(y,{title:"Fetching new quotes...",type:"folding-cube"}):null,null==t?null:o.createElement("abbr",{className:"mr-1",title:"Error: ".concat(t)},o.createElement("span",{"aria-label":"Connection error",className:"text-danger",role:"img"},"\u26a0\ufe0f")),o.createElement("small",null,o.createElement("span",{className:"text-white-50"},"Quotes last fetched: "),null==n?o.createElement("span",{className:"text-white"},"never"):o.createElement("time",{className:"text-white",dateTime:new Date(n).toISOString()},g.format(n))),o.createElement(i.a,{className:"ml-2",onClick:this.openSettingsModal,size:"sm"},"Settings")),o.createElement(i.i,{isOpen:null!=this.state.activeModal&&"settings"===this.state.activeModal.type,toggle:this.closeActiveModal},o.createElement("form",{onSubmit:this.handleSetIexApiKey},o.createElement(i.j,null,o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"apiKey"},"IEX Publishable API Key"),o.createElement("input",{className:"form-control",id:"apiKey",name:"apiKey",onChange:this.setNextIexApiKey,placeholder:"pk_abc123\u2026",value:this.state.nextIexApiKey,required:!0}))),o.createElement(i.k,null,o.createElement(i.a,{color:"secondary",onClick:this.closeActiveModal,outline:!0,type:"button"},"Cancel"),o.createElement(i.a,{color:"primary",type:"submit"},"Save")))))}}]),n}(o.Component),v=Object(s.e)(Object(S.b)((function(e){return{allIexSymbols:e.allIexSymbols,fetchErrorMessage:e.fetchErrorMessage,iexApiKey:e.iexApiKey,isLoading:e.isFetchingCount>0,updatedAt:e.updatedAt}}))(C)),I=o.lazy((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,252))})),F=o.lazy((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,253))})),j=o.lazy((function(){return Promise.all([n.e(3),n.e(8)]).then(n.bind(null,254))})),x=o.lazy((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,255))}));function L(){return o.createElement("div",{className:"container my-3"},o.createElement("div",{className:"d-flex align-items-center"},o.createElement(y,{className:"mr-2",type:"folding-cube"}),"Loading\u2026"))}function N(){var e=Object(S.c)();return o.useEffect((function(){e(Object(p.h)())}),[e]),o.createElement(r.a,null,o.createElement("div",null,o.createElement(s.a,{component:v}),o.createElement(o.Suspense,{fallback:o.createElement(L,null)},o.createElement(s.a,{exact:!0,path:"/",component:I}),o.createElement(s.a,{path:"/performance",component:F}),o.createElement(s.a,{path:"/stocks/:symbol",component:j}),o.createElement(s.a,{path:"/transactions",component:x})),o.createElement("footer",{className:"bg-light py-4"},o.createElement(i.d,null,o.createElement(i.q,null,o.createElement(i.b,null,o.createElement("small",{className:"text-secondary"},"Created by Ross Allen <",o.createElement("a",{className:"link-secondary",href:"https://github.com/ssorallen"},"ssorallen"),">"," ",o.createElement("span",{"aria-label":"",role:"img"},"\ud83e\udd89")))),o.createElement(i.q,null,o.createElement(i.b,null,o.createElement("small",{className:"text-secondary"},"Source available at"," ",o.createElement("a",{className:"link-secondary",href:"https://github.com/ssorallen/finance"},"ssorallen/finance")))),o.createElement(i.q,null,o.createElement(i.b,null,o.createElement("small",{className:"text-secondary"},"Data provided by"," ",o.createElement("a",{className:"link-secondary",href:"https://iexcloud.io"},"IEX Cloud"))))))))}var R=n(12),k=n.n(R),w=n(58),U=n.n(w),M=n(3),D=n(27),q=n(59),Q=n.n(q),H=n(26),K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function P(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var B=n(60),Y=document.getElementById("root");if(null==Y)throw new Error("Missing element #root to render app");var X=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||a.c,z=Object(a.d)((function(e,t){switch(t.type){case"ADD_SYMBOL":var n=-1===e.symbols.indexOf(t.symbol)?[].concat(Object(D.a)(e.symbols),[t.symbol]):e.symbols;return Object(M.a)(Object(M.a)({},e),{},{symbols:n});case"ADD_TRANSACTION":var a=-1===e.symbols.indexOf(t.transaction.symbol)?[].concat(Object(D.a)(e.symbols),[t.transaction.symbol]):e.symbols;return Object(M.a)(Object(M.a)({},e),{},{nextTransactionId:e.nextTransactionId+1,symbols:a,transactions:[].concat(Object(D.a)(e.transactions),[Object(M.a)(Object(M.a)({},t.transaction),{},{id:e.nextTransactionId})])});case"ADD_TRANSACTIONS":var o=new Set(e.symbols),c=e.nextTransactionId,r=t.transactions.map((function(e){o.add(e.symbol);var t=Object(M.a)(Object(M.a)({},e),{},{id:c});return c+=1,t}));return Object(M.a)(Object(M.a)({},e),{},{nextTransactionId:c,symbols:Array.from(o),transactions:e.transactions.concat(r)});case"CHANGE_PAGE_SIZE":return Object(M.a)(Object(M.a)({},e),{},{appSettings:Object(M.a)(Object(M.a)({},e.appSettings),{},{pageSize:t.pageSize})});case"DELETE_PORTFOLIO":return Object(M.a)(Object(M.a)({},e),{},{nextTransactionId:1,symbols:[],transactions:[]});case"DELETE_SYMBOLS":var s=t.symbols;return Object(M.a)(Object(M.a)({},e),{},{symbols:e.symbols.filter((function(e){return-1===s.indexOf(e)}))});case"DELETE_TRANSACTIONS":var i=t.transactions;return Object(M.a)(Object(M.a)({},e),{},{transactions:e.transactions.filter((function(e){return-1===i.indexOf(e)}))});case"DOWNLOAD_PORTFOLIO":var l=document.body;if(null==l)throw new Error("How in the hell did we get here?");var u=Q()(Object(H.b)(e.transactions,e.quotes),{columns:["Symbol","Name","Type","Date","Shares","Price","Cash value","Commission","Notes"],header:!0}),m=new Blob([u],{type:"text/csv"}),h=document.createElement("a"),p=URL.createObjectURL(m);return h.download="My Portfolio.csv",h.href=p,h.style.display="none",l.appendChild(h),h.click(),URL.revokeObjectURL(p),e;case"FETCH_ALL_IEX_SYMBOLS_FAILURE":return Object(M.a)(Object(M.a)({},e),{},{isFetchingAllIexSymbols:!1});case"FETCH_ALL_IEX_SYMBOLS_REQUEST":return Object(M.a)(Object(M.a)({},e),{},{isFetchingAllIexSymbols:!0});case"FETCH_ALL_IEX_SYMBOLS_SUCCESS":return Object(M.a)(Object(M.a)({},e),{},{allIexSymbols:t.allIexSymbols,isFetchingAllIexSymbols:!1});case"FETCH_SYMBOL_DATA_REQUEST":return Object(M.a)(Object(M.a)({},e),{},{isFetchingCount:e.isFetchingCount+1});case"FETCH_SYMBOL_DATA_FAILURE":return Object(M.a)(Object(M.a)({},e),{},{isFetchingCount:e.isFetchingCount-1});case"FETCH_SYMBOL_DATA_SUCCESS":return Object(M.a)(Object(M.a)({},e),{},{charts:Object(M.a)(Object(M.a)({},e.charts),{},{[t.symbol]:t.symbolData.chart}),isFetchingCount:e.isFetchingCount-1,quotes:Object(M.a)(Object(M.a)({},e.quotes),{},{[t.symbol]:t.symbolData.quote})});case"FETCH_QUOTES_FAILURE":return Object(M.a)(Object(M.a)({},e),{},{fetchErrorMessage:t.error.message,isFetchingCount:e.isFetchingCount-1});case"FETCH_QUOTES_REQUEST":return Object(M.a)(Object(M.a)({},e),{},{fetchErrorMessage:null,isFetchingCount:e.isFetchingCount+1});case"FETCH_QUOTES_SUCCESS":return Object(M.a)(Object(M.a)({},e),{},{isFetchingCount:e.isFetchingCount-1,quotes:t.quotes,updatedAt:Date.now()});case"SET_IEX_API_KEY":return Object(M.a)(Object(M.a)({},e),{},{iexApiKey:t.iexApiKey});default:return e}}),{allIexSymbols:null,appSettings:{pageSize:10},charts:{},fetchErrorMessage:null,iexApiKey:"",isFetchingAllIexSymbols:!1,isFetchingCount:0,nextTransactionId:1,quotes:{},symbols:[],transactions:[],updatedAt:null},X(Object(a.a)(B.a),U()(["allIexSymbols","appSettings","iexApiKey","nextTransactionId","quotes","symbols","transactions","updatedAt"],{key:"default"})));k.a.render(c.a.createElement(S.a,{store:z},c.a.createElement(N,null)),Y),function(){if("serviceWorker"in navigator){if(new URL("/finance",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/finance","/service-worker.js");K?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):P(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):P(e)}))}}()},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"j",(function(){return S}));var a,o=n(54),c=n.n(o),r=n(26),s="https://cloud.iexapis.com/v1";function i(e){return{transaction:e,type:"ADD_TRANSACTION"}}function l(e){return{pageSize:e,type:"CHANGE_PAGE_SIZE"}}function u(){return{type:"DELETE_PORTFOLIO"}}function m(e){return{symbols:e,type:"DELETE_SYMBOLS"}}function h(e){return{transactions:e,type:"DELETE_TRANSACTIONS"}}function p(){return{type:"DOWNLOAD_PORTFOLIO"}}function d(e){return{iexApiKey:e,type:"SET_IEX_API_KEY"}}function E(){null!=a&&(clearTimeout(a),a=null)}function f(e){return function(t,n){t({type:"FETCH_SYMBOL_DATA_REQUEST"}),fetch("".concat(s,"/stock/").concat(e,"/batch?types=chart,quote&range=1y&token=").concat(n().iexApiKey)).then((function(n){n.json().then((function(n){t({symbol:e,symbolData:n,type:"FETCH_SYMBOL_DATA_SUCCESS"})})).catch((function(e){t({error:e,type:"FETCH_SYMBOL_DATA_FAILURE"})}))})).catch((function(e){t({error:e,type:"FETCH_SYMBOL_DATA_FAILURE"})}))}}function b(){return function(e,t){function n(){E(),setTimeout((function(){e(b())}),3e5)}var a=t().symbols;if(0===a.length)return E(),void n();for(var o=[],c=[],r=0;r<a.length;r++)isNaN(a[r])||o.push(a[r]+".KS"),c.push(a[r]);E(),e({type:"FETCH_QUOTES_REQUEST"});var i={};fetch("".concat("https://query2.finance.yahoo.com/v7/finance/quote?formatted=true&crumb=eol1CBXFddY&lang=en-US&region=US&symbols=").concat(decodeURIComponent(o.join(","))),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then((function(t){t.json().then((function(t){for(var n=0;n<o.length;n++)i[t.quoteResponse.result[n].symbol]={companyName:t.quoteResponse.result[n].shortName,symbol:t.quoteResponse.result[n].symbol,latestPrice:t.quoteResponse.result[n].regularMarketPrice.raw,change:t.quoteResponse.result[n].regularMarketChange.raw,changePercent:t.quoteResponse.result[n].regularMarketChangePercent.raw,marketCap:t.quoteResponse.result[n].marketCap.raw};e({quotes:i,type:"FETCH_QUOTES_SUCCESS"})})).catch((function(t){e({error:t,type:"FETCH_QUOTES_FAILURE"})}))})).catch((function(t){e({error:t,type:"FETCH_QUOTES_FAILURE"})})).finally((function(){n()})),fetch("".concat(s,"/stock/market/batch?types=quote&token=").concat(t().iexApiKey,"&symbols=").concat(encodeURIComponent(c.join(",")))).then((function(t){t.json().then((function(t){Object.keys(t).forEach((function(e){i[e]=t[e].quote})),e({quotes:i,type:"FETCH_QUOTES_SUCCESS"})})).catch((function(t){e({error:t,type:"FETCH_QUOTES_FAILURE"})}))})).catch((function(t){e({error:t,type:"FETCH_QUOTES_FAILURE"})})).finally((function(){n()}))}}function y(){return function(e,t){e({type:"FETCH_ALL_IEX_SYMBOLS_REQUEST"}),fetch("".concat(s,"/ref-data/symbols?token=").concat(t().iexApiKey)).then((function(t){t.json().then((function(t){e({allIexSymbols:t,type:"FETCH_ALL_IEX_SYMBOLS_SUCCESS"})})).catch((function(t){e({error:t,type:"FETCH_ALL_IEX_SYMBOLS_FAILURE"})}))})).catch((function(t){e({error:t,type:"FETCH_ALL_IEX_SYMBOLS_FAILURE"})}))}}function S(e){return function(t){t({type:"IMPORT_TRANSACTIONS_FILE_REQUEST"});var n=new FileReader;n.onerror=function(){t({type:"IMPORT_TRANSACTIONS_FILE_FAILURE"})},n.onload=function(){var e=c()(n.result,{columns:!0});t({transactions:Object(r.a)(e),type:"ADD_TRANSACTIONS"}),t(b()),t({type:"IMPORT_TRANSACTIONS_FILE_SUCCESS"})},n.readAsText(e)}}},26:function(e,t,n){"use strict";function a(e){return e.map((function(e){return{cashValue:""===e["Cash value"]?null:parseFloat(e["Cash value"]),commission:parseFloat(e.Commission),date:e.Date,id:-1,notes:e.Notes,price:parseFloat(e.Price),shares:parseFloat(e.Shares),symbol:e.Symbol,type:e.Type}}))}function o(e,t){return e.map((function(e){return{"Cash value":null==e.cashValue?"":"".concat(e.cashValue),Commission:"".concat(e.commission),Date:null==e.date?"":e.date,Name:null==t[e.symbol]?"":t[e.symbol].companyName,Notes:null==e.notes?"":e.notes,Price:"".concat(e.price),Shares:"".concat(e.shares),Symbol:e.symbol,Type:e.type}}))}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}))},61:function(e,t,n){e.exports=n(111)},64:function(e,t,n){},66:function(e,t,n){},71:function(e,t){},73:function(e,t){},95:function(e,t,n){}},[[61,2,4]]]);
//# sourceMappingURL=main.4fd4774e.chunk.js.map